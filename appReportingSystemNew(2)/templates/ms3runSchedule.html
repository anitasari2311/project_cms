<html>
        
        <head>
        	<title>Run Schedule</title>
        	<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
        </head>

<body bgcolor="#F0FFF0">

{% if session.get('position') == 'Admin' %}
 <div class="topnav"><ul>
      <li><img src="/static/images/logoPharos.png" style="width: 150px; border: 0"></li>
      <div class="topnav-right">
          <li><a href="admin">HOME</a></li>
        
        <div class="dropdown">
          <button class="dropbtn">TASK
            <i class="fa fa-caret-down"></i>
          </button>

          <div class="dropdown-content">
            <a href="availableTask">AVAILABLE TASK</a>
            <a href="listTask">LIST TASK</a>
            <a href="historyTask">HISTORY TASK</a>
          </div>
        </div>
        
        <div class="dropdown">
          <button class="dropbtn">TEMPLATE
            <i class="fa fa-caret-down"></i>
          </button>

          <div class="dropdown-content">
            <a href="addTemplate">NEW TEMPLATE</a>
            <a href="formatTemplate">EDIT TEMPLATE</a>
          </div>
        </div>

        <div class="dropdown">
          <button class="dropbtn">QUERY
            <i class="fa fa-caret-down"></i>
          </button>

          <div class="dropdown-content">
            <a href="insertQuery">NEW QUERY</a>
            <a href="editQuery">EDIT QUERY</a>
          </div>
        </div>

          <li><a href="preview">PREVIEW</a></li>

        <div class="dropdown">
          <button class="dropbtn">SCHEDULING
            <i class="fa fa-caret-down"></i>
          </button>

          <div class="dropdown-content">
            <a href="addNewSchedule">NEW SCHEDULE</a>
            <a href="editSchedule">EDIT SCHEDULE</a>
            <a class="active" href="runSchedule">RUN SCHEDULE</a>
          </div>
        </div>

          <li><a href="listReport">LIST REPORT</a></li>
        
        <div class="dropdown">
          <button class="dropbtn">ACCOUNT
            <i class="fa fa-caret-down"></i>
          </button>

          <div class="dropdown-content">
            <a href="changePass">EDIT PROFILE</a>
            <a href="login">LOGOUT</a>
          </div>
        </div>
      </div>
    </ul></div>

{% else %}
<div class="topnav"><ul>
  <li><img src="/static/images/logoPharos.png" style="width: 150px; border: 0"></li>
  <div class="topnav-right">
      <li><a href="spv">HOME</a></li>
      
      <div class="dropdown">
        <button class="dropbtn">TASK
          <i class="fa fa-caret-down"></i>
        </button>

        <div class="dropdown-content">
          <a href="availableTaskSPV">AVAILABLE TASK</a>
          <a href="listTask">LIST TASK</a>
          <a href="onProgressTask">ON PROGRESS TASK</a>
          <a href="historyTask">HISTORY TASK</a>
        </div>
      </div>
      
      <div class="dropdown">
        <button class="dropbtn">TEMPLATE
          <i class="fa fa-caret-down"></i>
        </button>

        <div class="dropdown-content">
          <a href="addTemplate">NEW TEMPLATE</a>
          <a href="formatTemplate">EDIT TEMPLATE</a>
        </div>
      </div>

      <div class="dropdown">
        <button class="dropbtn">QUERY
          <i class="fa fa-caret-down"></i>
        </button>

        <div class="dropdown-content">
          <a href="insertQuery">NEW QUERY</a>
          <a href="editQuery">EDIT QUERY</a>
        </div>
      </div>

        <li><a href="preview">PREVIEW</a></li>

      <div class="dropdown">
        <button class="dropbtn">SCHEDULING
          <i class="fa fa-caret-down"></i>
        </button>

        <div class="dropdown-content">
          <a href="addNewSchedule">NEW SCHEDULE</a>
          <a href="editSchedule">EDIT SCHEDULE</a>
          <a class="active" href="runSchedule">RUN SCHEDULE</a>
        </div>
      </div>

        <li><a href="listReport">LIST REPORT</a></li>
              
      <div class="dropdown">
          <button class="dropbtn">ACCOUNT
            <i class="fa fa-caret-down"></i>
          </button>

          <div class="dropdown-content">
            <a href="changePass">EDIT PROFILE</a>
            <a href="login">LOGOUT</a>
          </div>
      </div>

      </div>
    </ul></div>


{% endif %}

<br><br><br>

<center>

              <h1>TODAY'S REPORT TO RUN</h1>
                <table id="list">
                  <tr >
                    <th style="background-color: #98AFC7;">Report Code</th>
                    <th style="background-color: #98AFC7;">Organization</th>
                    <th style="background-color: #98AFC7;">Category</th>
                    <th style="background-color: #98AFC7;">Receiver</th>
                    <th style="background-color: #98AFC7;">Server</th>
                    <th style="background-color: #98AFC7;">Months</th>
                    <th style="background-color: #98AFC7;">Day</th>
                    <th style="background-color: #98AFC7;">Date</th>
                  </tr>

                {% for row in kodeToday %}
                  <tr>

                    <td>{{row.reportId}}</td>
                    <td>{{row.org_id}} - {{row.orgNama}}</td>
                    <td>{{row.ktgri_id}} - {{row.kateNama}}</td>
                    <td>{{row.namaPenerima}}</td>
                    <td>{{row.server_id}}</td>
                    <td>{{row.schBulan}}</td>
                    <td>{{row.schHari}}</td>
                    <td>{{row.schTanggal}}</td>
                    
                  </tr>
                {% endfor %}
                 
                </table>

<br><br>

          <h1>SUCCESS</h1>

            <table id="list">
              <tr>
                <th>Report Code</th>
                <th>Organization</th>
                <th>Category</th>
                <th>Run Date</th>
                <th>Run Time</th>
                <th>End Time</th>
                <th>Server</th>
              </tr>
                  
              {% for row in statusSchedule %}
                {% if row.runStatus == 'B' %}
                  <tr >
                    <td>{{row.reportId}}</td>
                    <td>{{row.orgId}} - {{row.orgNama}}</td>
                    <td>{{row.ktgriId}} - {{row.kateNama}}</td>
                    <td>{{row.runDate}}</td>
                    <td>{{row.runStartTime}}</td>
                    <td>{{row.runEndTime}}</td>
                    <td>{{row.serverId}}</td>
                  </tr>
                {% endif %}
              {% endfor %} 
            </table>

<br><br>

              <h1>FAILED TO RUN</h1>
                <table id="list">
                  <tr>
                    <th style="background-color: #F87217;">Report Code</th>
                    <th style="background-color: #F87217;">Organization</th>
                    <th style="background-color: #F87217;">Category</th>
                    <th style="background-color: #F87217;">Run Date</th>
                    <th style="background-color: #F87217;">Run Time</th>
                    <th style="background-color: #F87217;">End Time</th>
                    <th style="background-color: #F87217;">Server</th>
                    <th style="background-color: #F87217;">Error Description</th>
                    <th style="background-color: #F87217;">Re-run</th>
                  </tr>
                  
                  {% for row in statusSchedule %}
                    {% if row.runStatus == 'G' %}
                     <tr>
                      <td>{{row.reportId}}</td>
                      <td>{{row.orgId}} - {{row.orgNama}}</td>
                      <td>{{row.ktgriId}} - {{row.kateNama}}</td>
                      <td>{{row.runDate}}</td>
                      <td>{{row.runStartTime}}</td>
                      <td>{{row.runEndTime}}</td>
                      <td>{{row.serverId}}</td>
                      <td>{{row.errorDesc}}</td>
                      <td>
                        <button id="{{row.reportId}}" class="submit" onclick= "click_process(this.id)" name="rerunButton" value="{{row.reportId}}">Run</button>

                          <div id="modal2{{row.reportId}}" class="modal">

                      <!-- Modal content -->

              <form action='/reRun' method='POST'>
                      <div class="modal-content">
                        <span class="close" onclick="closeModal2()">&times;</span>
                        <center>
                        <strong>Re-Run {{row.reportId}}</strong>
                        <br><br><br>
                        <p>Confirm Re-Run?</p>
                      </center>
                         <button name="kodLap" value ="{{row.reportId}}"> OK </button>
                      </div>
              </form>
                    </div>

                          </td>
                      </tr>
                    {% endif %}
                  {% endfor %}
                </table>






</div>  <!-- DIV / -->

    </body>
<script>

  var btnProcess2;
  var modalItem2;
  // // When the user clicks on <span> (x), close the modal
  function  closeModal2() {
    modalItem2.style.display = "none";
  }
  // // When the user clicks anywhere outside of the modal, close it
  window.onclick = function(event) {
    if (event.target == modalItem2) {
      modalItem2.style.display = "none";
    }
  }
  function show_modal(modalId){
    modalItem2 = document.getElementById(modalId);
    modalItem2.style.display = 'block';
  }
  function click_process(processId){
    show_modal('modal2'+processId);
    //alert('modal'+processId);
  }
</script>


</html>
